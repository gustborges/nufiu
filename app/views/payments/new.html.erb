<!-- app/views/payments/new.html.erb -->
<div class="add-margins">
  <h1>ðŸ’³ Detalhes para Pagamento</h1>
  <p>Confira as informaÃ§Ãµes e adicione os seus dados de pagamento.</p>
</div>

  <div class="cart">
    <div class="col">
      <% current_user.carts.last.cart_plants.each do |cart_plant| %>
        <p><%= cart_plant.amount %> X <%= cart_plant.plant.name %> = <%= cart_plant.plant.price * cart_plant.amount %></p>
      <% end %>
      <p><strong>Total:</strong><%= @order.amount / 100 %></p>
      <button id="pay" class="green-button">Pagar</button>
      
      <script src="https://js.stripe.com/v3/"></script>
      <script>
        const paymentButton = document.getElementById('pay');
        paymentButton.addEventListener('click', () => {
          const stripe = Stripe('<%= ENV['STRIPE_PUBLISHABLE_KEY'] %>');
          stripe.redirectToCheckout({
            sessionId: '<%= @order.checkout_session_id %>'
          });
        });
      </script>

    </div>
  </div>